function [p1, p2] = computePerpendicular(A,P,B, w)
a = 1;
b = -2*P(1,:);
c = P(1,:)^2 - (w^2 * (A(2,:) - B(2,:))^2)/((A(1,:)-B(1,:))^2+(A(2,:)-B(2,:))^2);

x1 = (-b + sqrt(b^2 -4*a*c))/2*a;
x2 = (-b - sqrt(b^2 -4*a*c))/2*a;


if(A(2,:)-B(2,:))~=0
    y1 = P(2,:)+ (A(1,:)-B(1,:))*(P(1,:)-x1)/(A(2,:)-B(2,:));
    y2 = P(2,:)+ (A(1,:)-B(1,:))*(P(1,:)-x2)/(A(2,:)-B(2,:));
else
    y1 = A(2,:) + w;
    y2 = A(2,:) - w;
end

p1 = [x1; y1];
p2 = [x2; y2];
end

